# Dataplane Router in C

## Functionalitate
Codul implementeaza in C un router care ofera functionalitati de forwarding a pachetelor IPv4 in functie de tabela de rutare si gestioneaza primirea/trimiterea unor pachete de tip ARP/ICMP.

## Algoritmi si structuri de date folosite
- Trie pentru tabela de rutare
    - Fiecare intrare din tabela de rutare este inserata in trie pe baza valorii prefixului si a mastii acesteia. Pentru fiecare intrare efectuam (numarul de biti de 1 din masca) pasi, astfel complexitatea temporala e O(N * 32). Aceeasi limita se aplica si pentru complexitatea sptiala, insa in realitate aceasta va fi mult mai mica, deoarece multe adrese au un multi biti in comun. 
    - Pentru cautarea unei adrese, vom efectua maxim 32 pasi, deci cautarea este O(32).
- Cozi IP pentru ARP
    - De fiecare data cand router-ul trebuie sa trimita un pachet la o anumita adresa IP pentru care nu cunoaste adresa MAC, pachetul respectiv este introdus intr-o coada asociata IP-ului respectiv. Atunci cand router-ul primeste un ARP reply, toate pachetele din coada respectiva sunt trimise. 
    - Intrucat numarul de noduri din cadrul retelei simulate in tema este mic, am folosit un array de cozi, cautarea si inserarea avand complexitate liniara.
    - In cozi se afla elemente de tip struct packet, o structura auxiliara ce stocheaza continutul pachetului, lungimea si interfata pe care trebuie trimis. 

## Protocoale implementate
- IP forwarding
    - Router-ul inspecteaza fiecare pachet IP si verifica daca adresa de destinatie corespunde cu una dintre interfetele proprii. 
        - Daca da si pachetul este ICMP Echo Request, raspunde cu ICMP Echo Reply
        - Daca nu, cauta cea mai buna ruta pentru forwarding in trie si trimite pachetul pe interfata respectiva.
    - Verifica si actualizeaza campul TTL al pachetului. Daca TTL ≤ 1, genereaza un mesaj ICMP de tip Time Exceeded.
    - Daca nu exista ruta catre destinatie, se trimite un ICMP de tip Destination Unreachable.
- ARP
    - Daca nu exista o intrare ARP pentru IP-ul next-hop, se genereaza o cerere ARP (ARP Request) si pachetul este adaugat in coada asociata acelui IP.
    - La primirea unui ARP Reply, router-ul:
        - Actualizeaza tabela ARP.
        - Trimite toate pachetele in asteptare din coada asociata IP-ului respectiv.
- ICMP
    - Raspunde la pachete ICMP Echo Request (ping) cu Echo Reply, daca sunt destinate router-ului.
    - Genereaza mesaje ICMP pentru:
        - Time excedeed, tip 11
        - Destination Unreachable, tip 3
## Structuri principale
- **struct node** - nod din trie pentru tabela de rutare.
- **struct packet** – retine datele unui pachet in coada de asteptare (buffer, lungime, interfata).
- **ip_queue_entry** – asociaza o adresa IP unei cozi de pachete.
- **arp_table_entry** – retine asocierile IP ↔ MAC.
- **route_table_entry** - intrare in tabela de rutare (prefix, masca, next hop, interfata).